<html lang="en">

{% extends 'base_template.jinja2' %}
{% block content %}

<head>
	<title>Shipment Details</title>
</head>
<body>

<h2>Editing Shipment:</h2>

    <div>
        <table border="1" cellpadding="5">
            <!-- display Shipment that is currently being edited-->
            {% if readShipment %}
                <thead>
                    <tr>
                        {% for key in readShipment[0].keys() %}
                        <th scope="col" data-field="{{ key }}" data-filter-control="input">{{ key }}</th>
                        {% endfor %}
                    </tr>
                <tbody>
                    {% for item in readShipment %}
                    <tr>
                        {% for key in item.keys() %}
                        <td>{{item[key]}}</td> {% endfor %}
                    </tr>
                    {% endfor %}
            {% endif %}
        </table>
    </div>

<br>
<br>

	<div id="edit">
	<!-- form to edit data in Shipment-->
	<form id="editShipment" action="/edit_shipment/{{editShipment[0].shipmentID}}" method="post">
	<legend><strong>Update Shipment Details:</strong></legend>
		<fieldset>
                <!-- send previous values too -->
                <input type="hidden" value="{{ editShipment[0].user }}" class="form-control" id="prevUser"
                       name="prevUser" required>

				<input type="hidden" value="{{ editShipment[0].shipOrigin }}" class="form-control" id="prevShipOrigin"
                       name="prevShipOrigin" required>

				<input type="hidden" value="{{ editShipment[0].shipDest }}" class="form-control" id="prevShipDest"
                       name="prevShipDest" required>

				<input type="hidden" value="{{ editShipment[0].shipDate }}" class="form-control" id="prevShipDate"
                       name="prevShipDate" required>

				<input type="hidden" value="{{ editShipment[0].miscNote }}" class="form-control" id="prevMiscNote"
                       name="prevMiscNote" >
                <!-- end previous values -->

				<input type="hidden" value="{{ editShipment[0].shipmentID }}" class="form-control" id="shipmentID"
                       name="shipmentID" required>

				<label for="user">User Name: </label>
				<select name="user" id="user">
					<option selected>
						{{shipUser[0].name}}
					</option>
					{% for item in shipUsersOption %}
						{% for shipUsersOption in item %}
							<option> {{item[shipUsersOption]}} </option>
						{% endfor %}
					{% endfor %}
				</select>

				<label for="shipOrigin">Origin: </label>
				<input type="text" value="{{ editShipment[0].shipOrigin }}" class="form-control" id="shipOrigin"
                       name="shipOrigin" size="35"  pattern="[A-Za-z0-9, ]+"
                       title="Shipment Origin (Special characters not allowed besides commas" required>

				<label for="shipDest">Destination: </label>
				<input type="text" value="{{ editShipment[0].shipDest }}" class="form-control" id="shipDest"
                       name="shipDest" size="35"  pattern="[A-Za-z0-9, ]+"
                       title="Shipment Destination (Special characters not allowed besides commas" required>

				<label for="shipDate">Shipment Date: </label>
				<input type="Date" value="{{ editShipment[0].shipDate }}" class="form-control" id="shipDate"
                       name="shipDate" required>

				<label for="miscNote">Notes: </label>
				<input type="text" value="{{ editShipment[0].miscNote }}" class="form-control" id="miscNote"
                       name="miscNote" size="35" pattern="[A-Za-z0-9, ]+"
                       title="Miscellaneous Notes (Special characters not allowed besides commas">

		</fieldset>

		<input type="submit" value="Update Shipment" name="Edit_Shipment" class="btn btn-primary" style="margin:.5rem;">
		<a href='/shipments'><input class="btn" type="button" value="Cancel"></a>

		</form>
	</div><!--edit-->

<p>&nbsp;</p>

	<div id="browse">
        <!-- populate list of Rocks in the Shipment-->
		<legend><strong>Rocks in This Shipment:</strong></legend>
		<table border="1" cellpadding="5">
			{% if rocks %}
			<thead>
				<tr>
					{% for key in rocks[0].keys() %}
                        <!-- skip first column -->
						{% if not loop.first %}
							<th scope="col" data-field="{{ key }}" data-filter-control="input">{{ key }}</th>
						{% endif %}
					{% endfor %}
				</tr>
			</thead>
			<tbody>
				{% for item in rocks %}
				<tr>
					{% for key in item.keys() %}
						{% if not loop.first %}
							<td> {{item[key]}} </td>
						{% endif %}
					{% endfor %}
					<td><a href="../delete_shipments_has_rocks/{{item.shipmentHasRockID}}" class="btn btn-default">Remove</a></td>
				</tr>
				{% endfor %}
			</tbody>
			{% endif %}
		</table>
		<p>Note: removing the last Rock will also delete the Shipment!</p>

	</div>	<!-- browse rocks in shipment-->

<br>

	<div id="edit">
	<!-- form to add rocks to Shipment-->
	<form id="addShipmentsHasRocks" action="/add_shipments_has_rocks/{{editShipment[0].shipmentID}}" method="post">
	<legend><strong>Add Rock to Shipment: </strong></legend>
		<fieldset>

        {% if addRocks|length == 0 %}
            <tr>No rocks remaining!</tr>

        {% else %}
			<tr>
				<select name="rock" id="rock">

                        {% for item in addRocks %}
                            {% for rock in item %}

                                <option> {{item[rock]}} </option>

                            {% endfor %}
                        {% endfor %}

				</select>

			</tr>

		</fieldset>
		<input type="submit" value="Add" name="Add_Shipments_has_Rocks" class="btn btn-primary" style="margin:.5rem;">
        {% endif %}
		</form>
	</div><!--edit-->


</body>

{% endblock %}

</html>
